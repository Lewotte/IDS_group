---
title: "Correlation Between Significant Events and Prison Population"
author: "by Gomakashi: Marcel, Sky, Hanna, Vivi, Siddhi & Maggie"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, include = FALSE}
library(tidyverse)
library(ggplot2)

#PACKAGES YOU MIGHT NEED TO INSTALL
library(readODS)
library(janitor) #for changing row names
library(RColorBrewer)
library(broom)

```


```{r load-data, include=FALSE}
Ethnic_PD <- read_ods('data/Population_30June2023_Annual.ods', sheet = 14)

#wrapper function for generating title of plots
wrapper <- function(x, ...) 
{
  paste(strwrap(x, ...), collapse = '\n')
}

#normalises data to range from 0 to 1
normalise_01 <- function(x)
{
  if (min(x) < 0 )
  {
    x/max(abs(x))
  } else {
    (x-min(x))/(max(x)-min(x))
  }
}


```


## Research Question: Correlation between significant events and prison population of England and Wales

We have picked some major worldwide events to see whether if there is a noticeable correlation between them and changes in prison population.

## Data

We explored the 'Prison population by type of custody, age group and sex' section of the data.

The data set we looked at contained many custody groups like remand(individuals that are held in prison until their trial/hearing), intermediate sentence(individuals that have to stay in custody until they have been approved to be safe for the public), fine defaulter(individuals that are in prison due to refusing to pay a fine) and recalls(individuals that were released on parole/license but broke the rules of their probation and are back in prison). 

Note to future editor:
Elaborate in this section on:
- the time resolution (how much time is spaced between consecutive data), how it went from once a year to once a month in 2011, etc.)
- explaination of other data set used

## Findings
### Prime Minister
For the Prime Minister section, we analyzed the full data set across all years to compare crime trends before and during each Prime Minister's term. However, limitations included difficulty in directly linking changes to specific policies, leading to some assumptions. To address this, we examined different crime types and related policies.

#### Main Steps Used in The Data

**1.Data Preparation** : Renamed columns, combined multiple datasets, and added an event indicator (before/after 2016-07-13).

**2.T-Test** : Compared average population before and after the event date. Created a boxplot to visualize differences.

**3.Linear Regression** : Modeled the relationship between population, time, and the event using regression. Evaluated the model’s accuracy with R-squared values.

**4.Time Series Forecasting** : Used historical data (2010–2016) to forecast population for 36 months. Compared forecasts to actual data from 2016–2019.

**5.Visualizations** : Plotted population trends and compared forecasts vs. real data using clear, color-coded charts.

#### Results (Key Issues and Possible Related Government Responses) 

#### Lord Cameron(2010-2016):

##### 1.Drug Offences

**Trend** : Significant decline after 2010

**Key Issues** : Shift from punitive measures to rehabilitation and tackling high-level trafficking.

**Government Response** : Expanded funding for drug treatment and harm reduction initiatives.

##### 2.Fraud Offences

**Trend** : Declined, reflecting a transition to cyber fraud.

**Key Issues** : Limited resources allocated for investigating complex fraud and increasing online scams

**Government Response** : Strengthened cybercrime units and encouraged private sector involvement in fraud prevention. 

##### 3.Rape

**Trend** : Reports and imprisonments steadily increased.

**Key Issues** : Greater awareness and public demand for action

**Government Response** : Funded support services and introduced training for handling rape cases.


##### 4.Robbery

**Trend** : Peaked early, then declined significantly

**Key Issues** : Economic recession initially drove rates up, while urban safety measures later reduced offenses.

**Government Response** : Promoted urban safety initiatives like CCTV and improved penalties for violent robbery.


##### 5.Theft Offences 

**Trend** : Declined after an intial rise.

**Key Issues** : Technological advancements in security deterred theft.

**Government Response**: Supported public safety campaigns and neighbourhood watch programs.


#### Theresa May(2016-2019):

##### 1.Drug Offences

**Trend** : Fluctuated, with a rise linked to county lines operations.

**Key Issues** : Vulnerable individuals exploited by organized crime.

**Government Response** : Strengthened the National Crime Agency (NCA) and introduced targeted interventions.


##### 2.Fraud Offenses

**Trend** : Continue declined due to a shift towards cyber fraud. 

**Key Issues** : Limited resources for complex fraud investigations.

**Government Response** : Promoted private sector collaboration and expanded cybercrime units.


##### 3.Rape

**Trend** : Reports rose sharply, reflecting increased awareness

**Key Issues** : Persistent gaps in convictions despite higher reporting.

**Government Response** : Improved victim support and police training for sensitive cases.

##### 4.Robbery

**Trend** : Steep decline due to improved surveillance and urban safety measures.

**Key Issues** : Economic challenges and reduced police presence.

**Government Response** : Strengthened penalties and promoted urbvan safety programs.


##### 5.Theft Offences

**Trend** : Consistently declined due to imporved security measures.

**Key Issues** : Shift from physical theft to online fraud

**Government Response** : Supported neighborhood watch programs and public awareness campaigns. 

#### Final Analysis

Based on the final graph in the presentation slides, here are the key observations :

The graph compares the predicted prison population (blue line) with the actual population (red line). During Cameron's period, the population followed a steady forecast, but under May, the red line shows more fluctuations and even deviates from the forecast, indicating unexpected challenges or policy changes. The orange lines (Hi 95 and Lo 95) represent expected variation, but the actual population sometimes falls outside this range, showing greater instability during May's term.

### COVID

#### How custody types changes

#### How lockdown affect the prisoner population

To prove our findings further. We start an analysis aimed to model the rate of change in the prisoner population (d1_Count) over time, focusing on adult prisoners in sentenced custody, and considering the impact of the COVID-19 lockdown period. 

##### Methods

Three linear regression models were fitted to the data:

1. **Model 1 (custody_fit_yesInt)**: This model included the variables `Date`, `lockdown_happens`, and the interaction between these two variables (`Date * lockdown_happens`). This model assesses how the lockdown period affected the population change in sentenced custody over time while accounting for the general time trend.

2. **Model 2 (custody_fit_noInt)**: This model excluded the interaction term and included only the main effects of `Date` and `lockdown_happens`.

3. **Model 3 (custody_fit_Simple)**: The simplest model included only `lockdown_happens` as a predictor.

##### Results

**Model 1 (custody_fit_yesInt)** The estimates for Date and the interaction term are negligible and statistically insignificant (p-values > 0.7). The lockdown_happens estimate is large (17006) but not significant (p = 0.738). It has the lowest adjusted R-squared (0.1663), suggesting minimal explanatory power for the interaction effect. 

**Model 2 (custody_fit_noInt)** Without interaction, the lockdown_happens variable retains a strong negative estimate (-632, p < 0.001), while Date’s estimate (0.00795) is not significant (p = 0.702). It has a slightly higher adjusted R-squared (0.1699), indicating that the interaction term does not add significant value.

**Model 3 (custody_fit_Simple)** With only lockdown_happens, it shows a strong negative estimate for lockdown_happens (-629, p < 0.001). It has the highest adjusted R-squared (0.1734), showing that lockdown_happens is the key factor of variance in d1_Count without additional predictors or interactions.

##### Interpretion

According to Occam's Razor, the simplest model that still provides meaningful explanatory power should be choosed. Since the r-squared of Model 3 is the highest and its simplicity, this makes it the most interpretable for directly assessing the lockdown’s effect without accounting for temporal trends or interactions. 
   
The lower Adjusted R-squared values across all models suggest that other unaccounted factors might also influence changes in the prisoner population. Variables such as policy changes, release rates, or crime trends could play a role.










The length should be roughly 1,500 words. 
If you want to use a word count addin, you can install this by copying and pasting the following into RStudio:

`devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE)`

You will then need to restart RStudio. Once you have done that, select the text you want to count the words of, go to Addins, and select the `Word count` addin.
This addin counts words using two different algorithms, but the results should be similar and as long as you're in the ballpark of 1,500 words, you're good! 
The addin will ignore code chunks and only count the words in prose. If you don't want to use the addin you can always copy and paste the text into Microsoft Word to do a Word Count!

You can also load your data here and present any analysis results / plots.
Make sure to hide your code with  `echo = FALSE` unless the point you are trying to make is about the code itself, in which case you should show your code.




## References

Ministry of Justice, Offender Management Statistics Quarterly publications, "Prison population: 30 June 2023", Retrieved November 8, 2024, Available at: https://www.gov.uk/government/collections/offender-management-statistics-quarterly

